---
title: "timezoneã¨device_calendarã‚’ä½µç”¨ã™ã‚‹éš›ã®æ³¨æ„ç‚¹"
emoji: "ğŸ˜º"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Flutter"]
published: true
---

# æ¦‚è¦

[timezone](https://pub.dev/packages/timezone) ã¨ [device_calendar](https://pub.dev/packages/device_calendar) ã‚’ä½µç”¨ã—ãŸéš›ã«ã€æ€ã‚ã¬æŒ™å‹•ã«é­é‡ã—ãŸã®ã§ã€ãã®å‚™å¿˜éŒ²ã§ã™ã€‚
çµè«–ã‹ã‚‰æ›¸ãã¨ã€timezone ã¨ device_calendar ã‚’ä½µç”¨ã™ã‚‹éš›ã¯ã€DeviceCalendarPlugin ã®åˆæœŸåŒ–æ™‚ã«`shouldInitTimezone: false`ã«ã—ã¾ã—ã‚‡ã†ã€‚

```dart
// shouldInitTimezoneã‚’falseã«ï¼
final deviceCalendarPlugin = DeviceCalendarPlugin(shouldInitTimezone: false)
```

# å•é¡Œ

timezone ã¨ device_calendar ã‚’ä½µç”¨ã—ãŸæ‰€ã€ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã« ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ ã‚’ Asia/Tokyo ã§åˆæœŸåŒ–ã—ã¦ã„ã‚‹ã®ã«ã€ä»–ã®å ´æ‰€ã§`tz.local`ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ UTC ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚

```dart
/// ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³åˆæœŸåŒ–å‡¦ç†
Future<void> _setupTimezones() async {
  tz.initializeTimeZones();
  final locationName = await FlutterTimezone.getLocalTimezone();
  final location = tz.timeZoneDatabase.getLocation(locationName);
  tz.setLocalLocation(location);
  print('tz.local: ${tz.local}'); // tz.local: Asia/Tokyo
}

/// ã‚¢ãƒ—ãƒªå†…ã®ã©ã“ã‹ã®é–¢æ•°
void somePlace() {
  print('tz.local: ${tz.local}'); // tz.local: UTC
}
```

# åŸå› 

åŸå› ã¨ã—ã¦ã¯ã€`DeviceCalendarPlugin`ã‚’`shouldInitTimezone: true`ã§åˆæœŸåŒ–ã™ã‚‹ã¨ã€`DeviceCalendarPlugin`å†…ã§ã‚‚ ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ ã®åˆæœŸåŒ–ãŒå®Ÿè¡Œã•ã‚Œã€ãã®éš›ã« `tz.local`ãŒ UTC ã¨ã—ã¦åˆæœŸåŒ–ã•ã‚Œã¦ã—ã¾ã†ã“ã¨ã§ã—ãŸã€‚

```dart:device_calendar.dart
factory DeviceCalendarPlugin({bool shouldInitTimezone = true}) {
  if (shouldInitTimezone) {
    tz.initializeTimeZones(); // <- ã“ã“ã§ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³åˆæœŸåŒ–ã•ã‚Œtz.localãŒUTCã«
  }
  return _instance;
}
https://github.com/builttoroam/device_calendar/blob/a6352f60480e8ff92bd058af52768d079a9c4cc1/lib/src/device_calendar.dart#L25-L30
```

# è§£æ±ºç­–

DeviceCalendarPlugin ã‚’åˆæœŸåŒ–ã™ã‚‹éš›ã«ã€`shouldInitTimezone: false`ã¨ã—ã¦åˆæœŸåŒ–ã—ã¾ã—ã‚‡ã†ã€‚

```dart
final deviceCalendarPlugin = DeviceCalendarPlugin(shouldInitTimezone: false)
```

# å‚™è€ƒ

ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¯ã„ã¤ã®é–“ã«ã‹ä»–ã‹ã‚‰ä¸Šæ›¸ãã•ã‚Œã¦ã—ã¾ã†ã“ã¨ã‚‚ã‚ã‚Šã€ã‚„ã£ã±ã‚Šæ€–ã„ã§ã™ã­ã€ã€
èª¿æŸ»ã«æ„å¤–ã¨æ™‚é–“ãŒã‹ã‹ã£ãŸã®ã§ã€èª°ã‹ã«ãŠå½¹ã«ç«‹ã¦ã‚Œã°å¹¸ã„ã§ã™ ğŸ™Œ
