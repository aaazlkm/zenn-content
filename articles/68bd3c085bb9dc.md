---
title: "Flutter3.24ç³»ã«ã‚ã’ãŸã‚‰ã€AndroidãŒãƒ“ãƒ«ãƒ‰ã§ããªããªã‚ã£ãŸã‚ãªãŸã¸"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Flutter", "Android"]
published: true
---

# æ¦‚è¦

Flutter3.24 ç³»ã«ã‚ã’ãŸã‚‰ã€ä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ã§ Android ãŒãƒ“ãƒ«ãƒ‰ã§ããªããªã£ãŸã®ã§ã€ãã‚Œã®è§£æ±ºç­–ã‚’ã¾ã¨ã‚ã¾ã™ã€‚

```text
* What went wrong:
Execution failed for task ':fluttertoast:checkDebugAndroidTestAarMetadata'.
> A failure occurred while executing com.android.build.gradle.internal.tasks.CheckAarMetadataWorkAction
   > 14 issues were found when checking AAR metadata:

       1.  Dependency 'androidx.fragment:fragment:1.7.1' requires libraries and applications that
           depend on it to compile against version 34 or later of the
           Android APIs.

           :fluttertoast is currently compiled against android-33.

           Recommended action: Update this project to use a newer compileSdk
           of at least 34, for example 35.

           Note that updating a library or application's compileSdk (which
           allows newer APIs to be used) can be done separately from updating
           targetSdk (which opts the app in to new runtime behavior) and
           minSdk (which determines which devices the app can be installed
           on).
```

```txt
* What went wrong:
Execution failed for task ':in_app_review:processDebugAndroidTestManifest'.
> Manifest merger failed : uses-sdk:minSdkVersion 16 cannot be smaller than version 19 declared in library [androidx.fragment:fragment:1.7.1] /Users/xxx/.gradle/caches/8.9/transforms/acc9118fa488ce5128b339e11d95b742/transformed/fragment-1.7.1/AndroidManifest.xml as the library might be using APIs not available in 16
  	Suggestion: use a compatible library with a minSdk of at most 16,
  		or increase this project's minSdk version to at least 19,
  		or use tools:overrideLibrary="androidx.fragment" to force usage (may lead to runtime failures)
```

# åŸå› 

åŸå› ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸é–“ã® minSdkVersion ã¨ compileSdkVersion ãŒã‚ã£ã¦ã„ãªã„ã“ã¨ã§ã™ã€‚

- `fluttertoast`ã§ã¯ compileSdkVersion ãŒ 33 ã ãŒã€`fragment-1.7.1` ã§ã¯ compileSdkVersion ãŒ 34
- `in_app_review` ã§ã¯ minSdkVersion ãŒ 16 ã ãŒã€`fragment-1.7.1` ã§ã¯ minSdkVersion ãŒ 19

ã“ã‚Œã‚‰ã®ã‚¨ãƒ©ãƒ¼ã¯ã€Flutter3.24 ç³»ã«ãªã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å†…éƒ¨çš„ã«ä½¿ç”¨ã™ã‚‹ Android ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸Šã’ã¦ã„ã‚‹ãŸã‚ç”Ÿã˜ã¦ã„ã¾ã™ã€‚

- [Flutter3.22 ç³»ã® fragment ã¯ 1.1.0](https://github.com/flutter/engine/blob/3.22.0/tools/androidx/files.json#L29)
- [Flutter3.24 ç³»ã® fragment ã¯ 1.7.0](https://github.com/flutter/engine/blob/3.24.0/tools/androidx/files.json#L31)

# è§£æ±ºç­–

### æ ¹æœ¬çš„

æ ¹æœ¬çš„ãªè§£æ±ºç­–ã¨ã—ã¦ã¯ã€compileSdkVersion ã¨ minSdkVersion ãŒã‚ã£ã¦ãªã„ã“ã¨ãŒåŸå› ãªã®ã§ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å´ã«å¯¾å¿œã—ã¦ã‚‚ã‚‰ã†ã®ãŒä¸€ç•ªå®‰å…¨ã§ã™ã€‚
ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¦ã„ã‚‹ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãã‚Œãã‚Œä¾é ¼ã—ã¦ minSdkVersion ã¨ compileSdkVersion ã‚’ã‚ã’ã¦ã‚‚ã‚‰ã„ã¾ã—ã‚‡ã†ã€‚

### ä¸€æ™‚çš„

```gradle:android.gradle
subprojects {
    afterEvaluate { project ->
        if (
                ["flutter_timezone", "in_app_review", "fluttertoast"].contains(project.name) && // å¯¾è±¡ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã¿ä¸Šæ›¸ã
                        (project.plugins.hasPlugin("com.android.application") || project.plugins.hasPlugin("com.android.library")) // Androidå‘ã‘ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã‹ãƒã‚§ãƒƒã‚¯
        ) {
            println "Evaluating project: ${project.name}"

            project.android {
                compileSdkVersion 34
            }
            project.android.defaultConfig {
                minSdkVersion 19
            }
        }
    }
    project.evaluationDependsOn(':app')
}
```

ä¸€æ™‚çš„ã«ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã—ãŸã„å ´åˆã¯ã€ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å¯¾è±¡ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã® compileSdkVersion ã¨ minSdkVersion ã‚’ã‚¢ãƒ—ãƒªå´ã§å¼·åˆ¶çš„ã«ä¸Šæ›¸ãã—ã¾ã™ã€‚
ç„¡ç†ã‚„ã‚Šä¸Šæ›¸ãã—ã¦ã‚‹ã ã‘ãªã®ã§ã€ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚
ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å´ã§ã®å¯¾å¿œãŒã™ãã«ã¯è¦‹è¾¼ã‚ãªã„ï¼†ã“ã®ãƒªã‚¹ã‚¯ãŒè¨±å®¹ã§ãã‚‹å ´åˆã®ã¿ä½¿ç”¨ã™ã‚‹ã¨è‰¯ã•ãã†ã§ã™ã€‚
ã¾ãŸã€[issue](https://github.com/livekit/client-sdk-flutter/issues/569) ã‚„ [StackOverflow](https://stackoverflow.com/questions/78852476/error-launching-flutter-app-after-upgrading-to-sdk-version-3-24) ã§ã¯å…¨ã¦ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ›´æ–°ã™ã‚‹ã‚³ãƒ¼ãƒ‰ãŒæ•£è¦‹ã•ã‚Œã¾ã™ãŒã€ä»Šå¾Œ 35 ãªã©æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå‡ºãŸã¨ãã«ã‚‚ 34 ã«ä¸Šæ›¸ãã™ã‚‹ã‚ˆã†ãªå‡¦ç†ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
ãã®ãŸã‚ã€å¯¾è±¡ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã¿ã‚’æ›´æ–°ã™ã‚‹ã‚ˆã†ãªå‡¦ç†ã«ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚
