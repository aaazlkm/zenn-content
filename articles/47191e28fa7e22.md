---
title: "GithubActionsä¸Šã§è¤‡æ•°ã®private repoã‚’pub getã™ã‚‹æ–¹æ³•"
emoji: "ğŸ‘‹"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Flutter, Dart]
published: true
---

# æ¦‚è¦

```yaml
sample1:
  git:
    url: git@github.com:sample1/sample1.git
    ref: v1.0.0
sample2:
  git:
    url: git@github.com:sample2/sample2.git
    ref: v1.0.0
```

Flutter ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã„ã¦ã€ä¸Šè¨˜ã®ã‚ˆã†ã« private repo ã«ä¾å­˜ã—ã¦ã‚‹æ™‚ã€Github Actions ä¸Šã§ pub get ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
åŸå› ã¨ã—ã¦ã¯ã€Github Actions ãŒ private repo ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒæŒã£ã¦ã„ãªã„ãŸã‚ã§ã™ã€‚
[ã“ã¡ã‚‰ã®æ–¹æ³•](https://zenn.dev/najeira/articles/2023-03-31-zenn-xaehahc6phahdahkuphe)ã®é€šã‚Šã€private repo ãŒï¼‘ã¤ã®å ´åˆã¯ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’è¨­å®šã™ã‚Œã°ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
ãŸã ã—ã€private repo ãŒè¤‡æ•°ã®å ´åˆã¯ã€å„ private repo ã«å¯¾ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã‚’è¨­å®šã—ãªã„ã¨ã„ã‘ãªãã€ç®¡ç†ãŒç…©é›‘ã«ãªã‚Šã¾ã™ã€‚
ã“ã“ã§ã¯ã€ãƒã‚·ãƒ³ãƒ¦ãƒ¼ã‚¶ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å˜ä¸€ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚­ãƒ¼ã§è¤‡æ•°ã® private repo ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

# æ–¹æ³•

### 1.SSH ã‚­ãƒ¼ã®ç”Ÿæˆ

SSH ã‚­ãƒ¼ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯é©å®œèª¿æ•´ã—ã¦ãã ã•ã„ã€‚

```shell
ssh-keygen -t ed25519 -f key -C "xxx@example.com"
```

### 2.ãƒã‚·ãƒ³ãƒ¦ãƒ¼ã‚¶ã®è¨­å®š

é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã®ã¨åŒã˜ã‚ˆã†ã« Github ä¸Šã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
ãƒã‚·ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® "Settings > SSH and GPG keys > SSH Keys" ãƒšãƒ¼ã‚¸ã« ã€Œ1.SSH ã‚­ãƒ¼ã®ç”Ÿæˆã€ã§ä½œæˆã—ãŸå…¬é–‹éµã‚’ç™»éŒ²ã—ã¾ã™ã€‚
ã¾ãŸã€ãƒã‚·ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è©²å½“ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã¸ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ã¨ã—ã¦æ‹›å¾…ã—ã¾ã™ã€‚

### 3.ç§˜å¯†éµã‚’ç™»éŒ²

ä¸‹è¨˜ã§ã¯ ã€Œ1.SSH ã‚­ãƒ¼ã®ç”Ÿæˆã€ã§ä½œæˆã—ãŸç§˜å¯†éµã‚’ GithubActions ã® Secrets ã«`PRIVATE_SSH_KEY`ã¨ã—ã¦ç™»éŒ²ã—ã€`webfactory/ssh-agent`ã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã‚Š private repo ã® pub get ãŒå¯èƒ½ã«ãªã‚Šã¾ã—ãŸ ğŸ‰

```yaml
- uses: webfactory/ssh-agent@v0.7.0
  with:
  ssh-private-key: ${{ secrets.PRIVATE_SSH_KEY }}
- name: setup flutter
  id: flutter-action
  uses: subosito/flutter-action@v2
  with:
    channel: "stable"
- name: Install packages
  run: flutter pub get
```

# å‚™è€ƒ

> "ãƒœãƒƒãƒˆ" ã¾ãŸã¯ãã®ä»–ã®è‡ªå‹•åŒ–ã•ã‚ŒãŸæ‰‹æ®µã§ "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ" ã‚’ç™»éŒ²ã™ã‚‹ã“ã¨ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
> ã“ã‚Œã¯ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ç”Ÿæˆã‚’è‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ã¯ã§ããªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚ ã—ã‹ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„çµ„ç¹”å†…ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ã‚ˆã†ãªè‡ªå‹•åŒ–ã‚¿ã‚¹ã‚¯ã®ãŸã‚ã« 1 ã¤ã®ãƒã‚·ãƒ³ãƒ¦ãƒ¼ã‚¶ã‚’ä½œæˆã—ãŸã„ãªã‚‰ã€ãã‚Œã¯ã¾ã£ãŸãç´ æ™´ã‚‰ã—ã„ã“ã¨ã§ã™ã€‚
> https://docs.github.com/ja/authentication/connecting-to-github-with-ssh/managing-deploy-keys#machine-userss

åˆ©ç”¨è¦ç´„çš„ã«ã‚‚ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è‡ªå‹•ç”Ÿæˆã‚’ç¦æ­¢ã—ã¦ã‚‹ã ã‘ã§ã€è‡ªå‹•åŒ–ã‚¿ã‚¹ã‚¯ã®ãŸã‚ã«ãƒã‚·ãƒ³ãƒ¦ãƒ¼ã‚¶ã‚’ä½œæˆã™ã‚‹ã“ã¨ã¯è¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™

# å‚è€ƒ

https://zenn.dev/najeira/articles/2023-03-31-zenn-xaehahc6phahdahkuphe

https://docs.github.com/ja/authentication/connecting-to-github-with-ssh/managing-deploy-keys#machine-users
